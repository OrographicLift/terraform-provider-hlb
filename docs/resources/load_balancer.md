---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "hlb_load_balancer Resource - hlb"
subcategory: ""
description: |-
  Manages a Hero Load Balancer (HLB) resource. HLB is a managed load balancer service that distributes incoming application traffic across multiple targets, such as EC2 instances, in multiple Availability Zones. This resource allows you to create and manage load balancers with features like:
  HTTP/2 supportAccess loggingCross-zone load balancingCustom launch configurationsFlexible IP address types
  For detailed documentation and examples, see the HLB Provider Documentation ../index.md.
---

# hlb_load_balancer (Resource)

Manages a Hero Load Balancer (HLB) resource. HLB is a managed load balancer service that distributes incoming application traffic across multiple targets, such as EC2 instances, in multiple Availability Zones. This resource allows you to create and manage load balancers with features like:

* HTTP/2 support
* Access logging
* Cross-zone load balancing
* Custom launch configurations
* Flexible IP address types

For detailed documentation and examples, see the [HLB Provider Documentation](../index.md).

## Example Usage

```terraform
# Create a new HLB load balancer
resource "hlb_load_balancer" "example" {
  name         = "example-hlb"
  internal     = false
  subnets      = ["subnet-12345678", "subnet-87654321"]
  enable_http2 = true

  access_logs = {
    bucket  = "my-logs-bucket"
    prefix  = "my-hlb-logs"
    enabled = true
  }

  # Optional: customize the launch configuration
  launch_config = {
    instance_type      = "c7g.large"
    min_instance_count = 2
    target_cpu_usage   = 40
  }

  tags = {
    Environment = "production"
  }
}

output "load_balancer_dns" {
  value = hlb_load_balancer.example.dns_name
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the load balancer. Must be unique within your account, max 32 characters, alphanumeric and hyphens only. This name will be used in DNS records and AWS resource names, so choose something meaningful and compliant with DNS naming conventions.
- `subnets` (Set of String) List of subnet IDs to attach to the load balancer. The subnets must be in at least two different Availability Zones for high availability. For internal load balancers, these must be private subnets. For internet-facing load balancers, these must be public subnets.
- `zone_id` (String) The ID of the zone
- `zone_name` (String) The name of the zone

### Optional

- `access_logs` (Attributes) Configuration block for access log settings. Access logs capture detailed information about requests sent to your load balancer. Each log contains information such as the time the request was received, client's IP address, latencies, request paths, and server responses. This can be useful for:

* Analyzing traffic patterns
* Troubleshooting issues
* Security analysis

The logs are stored in the specified S3 bucket and can be analyzed using tools like Amazon Athena. (see [below for nested schema](#nestedatt--access_logs))
- `client_keep_alive` (Number) The time in seconds to keep client connections alive (60-604800 seconds, default 3600). This setting determines how long the load balancer maintains idle keepalive connections with clients. Longer values can improve performance by reducing connection establishment overhead, but consume more resources.
- `connection_draining_timeout` (Number) When a scale-in event occurs, load balancer nodes are taken out of the DNS record immediately but we wait for `connection_draining_timeout` minutes before terminating the instances. This is most useful with HTTP clients that do not respect DNS TLL.
- `ec2_iam_role` (String) Allows the user to assign a role permitting root access to proxy instances via AWS SSM. It is *stronly discouraged* to change this value as this compromises security on many levels. Use only to perfom audits. Valid values are:
* `lb-standard` (default)
* `lb-ssm`
The role will only be applied to newly created proxy instances, you must trigger an Autoscaling Group Instance Refresh manually for this change to take effect immediately.
- `enable_cross_zone_load_balancing` (String) Configures how the load balancer distributes traffic between Availability Zones. Valid values:

* `full` - Distributes traffic evenly across all instances in all zones
* `avoid` (default) - Attempts to distribute traffic within a zone first, only sending cross-zone traffic when necessary
* `off` - Keeps traffic within the same zone

The `avoid` mode helps optimize for both availability and performance while minimizing cross-AZ data transfer costs.
- `enable_deletion_protection` (Boolean) If true, deletion of the load balancer will be disabled via the API. This prevents accidental deletion of production load balancers. You must set this to false and apply the change before you can delete the load balancer.
- `enable_http2` (Boolean) Indicates whether HTTP/2 is enabled. HTTP/2 provides improved performance through features like multiplexing, header compression, and server push. Enabled by default. Only disable this if you have specific compatibility requirements with HTTP/1.x.
- `idle_timeout` (Number) The time in seconds that a connection is allowed to be idle (no data transfer) before it is closed by the load balancer. Valid values are 1-4000 seconds. Default is 60 seconds. Increase this if your application requires longer-lived idle connections.
- `internal` (Boolean) If true, the load balancer will be internal (private). Internal load balancers route traffic within your VPC and are not accessible from the internet. Use this for internal services or when you want to restrict access to your VPC. This cannot be changed after creation.
- `ip_address_type` (String) The type of IP addresses used by the subnets for your load balancer. Valid values:

* `ipv4` (default) - The load balancer has IPv4 addresses only
* `dualstack` - The load balancer has both IPv4 and IPv6 addresses
* `dualstack-without-public-ipv4` - The load balancer has IPv6 addresses and private IPv4 addresses

Choose based on your application's networking requirements and client compatibility needs.
- `launch_config` (Attributes) Configuration block for customizing how the load balancer instances are launched and scaled. This allows you to control the instance type, count, and scaling behavior. If not specified, the backend will use default values. It is recommended that you customize these settings to get the best performance / cost ratio,The best parameters can usually only be determined empirically with a righ-sizing exercise. (see [below for nested schema](#nestedatt--launch_config))
- `name_prefix` (String) Creates a unique name beginning with the specified prefix. Use this when you want Terraform to generate unique names for multiple load balancers. The prefix must be 1-6 characters long. Conflicts with the `name` attribute - you can only use one or the other.
- `preferred_maintenance_window` (String) Specifies a time window during which load balancer node forced replacement should preferably occur. An empty string is a valid value. The format is `ddd-ddd,hh24:mm-hh24:mm` where:

* `ddd-ddd` represents a day range (e.g., `mon-fri` for Monday to Friday)
* `hh24:mm-hh24:mm` represents a time range in 24-hour format in UTC (e.g., `01:00-03:00` for 1 AM to 3 AM UTC)

**Important:** All times are in UTC. The day of the week refers to the start time of the window. For time ranges that cross midnight, the window will finish on the next day.

Examples:
* `mon-wed,02:00-04:00` - Monday through Wednesday, between 2 AM and 4 AM UTC
* `mon-fri,23:00-02:00` - Monday through Friday, starting at 11 PM UTC each day and ending at 2 AM UTC the following day. The last window starts at 11 PM UTC Friday and ends at 2 AM UTC Saturday

When updates to the load balancer nodes are available, newly started instances always use the newest version, and older versions are progressively phased out as scale-in events occur. Additionally, any remaining instances running out-of-date versions will be automatically replaced during the specified maintenance window.

Valid values for days are:

* `mon` - Monday
* `tue` - Tuesday
* `wed` - Wednesday
* `thu` - Thursday
* `fri` - Friday
* `sat` - Saturday
* `sun` - Sunday

**Note:** Urgent updates may be applied outside of the preferred maintenance window and without notice. `connection_draining_timeout` is always respected.

If unspecified, non-urgent forced replacements will occur at night in the region.
- `preserve_host_header` (Boolean) If true, the load balancer preserves the original Host header value in requests forwarded to targets. This is useful when your backend application needs to know the original hostname requested by the client, for example with virtual hosting or when generating absolute URLs.
- `security_groups` (Set of String) List of security group IDs to assign to the load balancer. The security groups must allow inbound traffic on the listener ports and health check ports. They should also allow outbound traffic to your target instances or IP addresses, and the HLB control plane.
- `tags` (Map of String) A map of tags to assign to the load balancer and related resources. Tags are key-value pairs that help you organize and categorize your resources. Common uses include:

* Environment identification (e.g., `environment = "production"`)
* Cost allocation (e.g., `project = "mobile-app"`)
* Security/compliance labeling
* Automation and operations management
A maximum of 5 tags can be assigned (AWS Marketplace limitation).
- `xff_header_processing_mode` (String) Controls how the load balancer handles the X-Forwarded-For header. Valid values:

* `append` (default) - Appends the client IP to any existing X-Forwarded-For header
* `preserve` - Keeps the original X-Forwarded-For header unchanged
* `remove` - Removes any existing X-Forwarded-For header

This header is important for identifying the original client IP address when requests pass through the load balancer.

### Read-Only

- `dns_name` (String) The DNS name of the load balancer
- `id` (String) The ID of this resource.
- `state` (String) The state of the load balancer

<a id="nestedatt--access_logs"></a>
### Nested Schema for `access_logs`

Required:

- `bucket` (String) The name of the S3 bucket where access logs will be stored. The load balancer must have permissions to write to this bucket. You can use an existing bucket or create a new one. Make sure the bucket policy allows the load balancer to write logs.

Optional:

- `enabled` (Boolean) Whether to enable access logs
- `prefix` (String) The prefix (logical hierarchy) in the S3 bucket under which the logs are stored. If not specified, logs are stored in the root of the bucket. Example: `my-app/prod/` will store logs under that directory structure in the bucket.


<a id="nestedatt--launch_config"></a>
### Nested Schema for `launch_config`

Optional:

- `instance_type` (String) The EC2 instance type to use for the load balancer nodes. If not specified, the backend will choose an appropriate default (currently c7g.medium). Choose a larger instance type if you expect high traffic volumes or need more CPU/memory resources.
- `max_instance_count` (Number) The maximum number of instances to maintain (integer, minimum 1). This will be rounded down to a multiple of the number of Availability Zones. If not specified, the backend will choose 10 times the minimum instance count. This allows for substantial traffic spikes.
- `min_instance_count` (Number) The minimum number of instances to maintain (integer, minimum 1). This will be rounded up to a multiple of the number of Availability Zones to ensure high availability. If not specified, the backend will choose an set this value to the number of AZs.
- `target_cpu_usage` (Number) The target CPU usage percentage (10-90) for auto-scaling. The load balancer will add or remove instances to maintain this target CPU usage. Lower values result in more aggressive scaling out, while higher values optimize resource usage but may impact performance during traffic spikes.

## Import

Import is supported using the following syntax:

```shell
# Load balancer can be imported using its ID
terraform import hlb_load_balancer.example lb-1234567890abcdef
```
